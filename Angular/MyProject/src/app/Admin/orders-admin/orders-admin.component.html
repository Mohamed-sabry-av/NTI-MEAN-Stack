<div class="orders-admin"> 
    <h1>Orders Management</h1>
  
    <!-- Status Filter -->
    <div class="filter">
      <p class="filter-title">Filter by status:</p>
      <mat-select [(value)]="selectedStatus" (selectionChange)="filterOrders()" class="status-filter">
        <mat-option value="">All Statuses</mat-option>
        <mat-option *ngFor="let status of statusOptions" [value]="status">{{ status }}</mat-option>
      </mat-select>
    </div>
  
    <table mat-table [dataSource]="filteredOrders" class="orders-table mat-elevation-z8">
      <!-- Order ID Column -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> Order ID </th>
        <td mat-cell *matCellDef="let order"> {{ order._id }} </td>
      </ng-container>
  
      <!-- Customer Column -->
      <ng-container matColumnDef="customer">
        <th mat-header-cell *matHeaderCellDef> Customer </th>
        <td mat-cell *matCellDef="let order"> {{ order.fullName }} </td>
      </ng-container>
  
      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let order">
          <mat-select [(value)]="order.orderStatus" (selectionChange)="updateStatus(order)" class="order-status-select" [ngClass]="'status-' + order.orderStatus.toLowerCase()">
            <mat-option *ngFor="let status of statusOptions" [value]="status">
              {{ status }}
            </mat-option>
          </mat-select>
  
          <!-- Show Cancel Order Button if Status is Pending or in progress-->
          <div *ngIf="order.orderStatus === 'pending'||order.orderStatus === 'inProgress'" class="cancel-btn-container">
            <button mat-button color="warn" (click)="cancelOrder(order)" class="cancel-order-btn">Cancel Order</button>
          </div>
        </td>
      </ng-container>
  
      
      <!-- Delivery Fee Column -->
        <ng-container matColumnDef="deliveryFee">
            <th mat-header-cell *matHeaderCellDef> Delivery Fee </th>
            <td mat-cell *matCellDef="let order">
              <button mat-raised-button color="primary" (click)="openDeliveryDetailsDialog(order._id)">
                Update Delivery Details
              </button>
            </td>
        </ng-container>

      <!-- Placed On Column -->
      <ng-container matColumnDef="placedOn">
        <th mat-header-cell *matHeaderCellDef> Placed On </th>
        <td mat-cell *matCellDef="let order"> {{ order.createdAt | date: 'medium' }} </td>
      </ng-container>
        <!-- Add a View Details Button Column -->
        <ng-container matColumnDef="viewDetails">
            <th mat-header-cell *matHeaderCellDef> View Details </th>
            <td mat-cell *matCellDef="let order">
            <button mat-button color="primary" (click)="viewOrderDetails(order)">View Details</button>
            </td>
        </ng-container>
  
      <!-- Header and Row Definitions -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
  